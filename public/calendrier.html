<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="style.css" />
    <title>Calendrier - EventMakers</title>
  </head>

  <body class="bg-soft">
    <!-- HEADER -->
    <div id="headerContainer"></div>

    <button onclick="history.back()" class="ml-5 mt-5 text-3xl text-byzantium">
      <i class="fa-solid fa-arrow-left"></i>
    </button>

    <!-- üåü SECTION CALENDRIER -->
    <section class="container mx-auto px-5 mt-10 mb-20">
      <!-- üåø Conteneur du calendrier -->
      <div class="bg-ros√© p-6 rounded-3xl shadow-lg border border-melon mx-4">
        <!-- Navigation mois -->
        <div class="flex justify-center items-center gap-6 mb-6">
          <button
            id="prevMonth"
            class="px-4 py-2 bg-byzantium text-white rounded-xl hover:bg-byzantium/80"
          >
            ‚Üê
          </button>

          <h2 id="monthYear" class="font-title text-2xl"></h2>

          <button
            id="nextMonth"
            class="px-4 py-2 bg-byzantium text-white rounded-xl hover:bg-byzantium/80"
          >
            ‚Üí
          </button>
        </div>

        <!-- Grille calendrier -->
        <div class="grid grid-cols-7 gap-3 text-center font-body text-lg">
          <div class="font-bold">Lun</div>
          <div class="font-bold">Mar</div>
          <div class="font-bold">Mer</div>
          <div class="font-bold">Jeu</div>
          <div class="font-bold">Ven</div>
          <div class="font-bold text-melon">Sam</div>
          <div class="font-bold text-melon">Dim</div>
        </div>

        <div id="calendarDays" class="grid grid-cols-7 gap-3 mt-4"></div>
      </div>
    </section>

    <!-- FOOTER -->
    <div id="footerContainer"></div>

    <script>
      //header et footer et sidebar
      function initSidebar() {
        const sidebar = document.getElementById("profileSidebar");
        const backdrop = document.getElementById("sidebarBackdrop");
        const openBtn = document.getElementById("openSidebar");
        const closeBtn = document.getElementById("closeSidebar");

        if (!sidebar || !backdrop || !openBtn || !closeBtn) return;

        openBtn.onclick = () => {
          sidebar.classList.remove("translate-x-full");
          backdrop.classList.remove("hidden");
        };

        closeBtn.onclick = () => {
          sidebar.classList.add("translate-x-full");
          backdrop.classList.add("hidden");
        };

        backdrop.onclick = () => {
          sidebar.classList.add("translate-x-full");
          backdrop.classList.add("hidden");
        };
      }

      // üëâ Attendre que le header soit charg√©
      fetch("./header.html")
        .then((response) => response.text())
        .then((data) => {
          document.getElementById("headerContainer").innerHTML = data;
          initSidebar(); // üî• maintenant le script trouve les boutons !
        });

      fetch("./footer.html")
        .then((response) => response.text())
        .then((data) => {
          document.getElementById("footerContainer").innerHTML = data;
        });

      //caldenrier js
      const events = [
        { day: 5, month: 12, year: 2025 },
        { day: 16, month: 12, year: 2025 },
        { day: 28, month: 12, year: 2025 },
        { day: 24, month: 12, year: 2025 },
      ];
      const monthYear = document.getElementById("monthYear");
      const calendarDays = document.getElementById("calendarDays");

      let date = new Date();

      function generateCalendar() {
        const year = date.getFullYear();
        const month = date.getMonth();

        // Affichage du mois
        monthYear.textContent = date.toLocaleDateString("fr-FR", {
          month: "long",
          year: "numeric",
        });

        // Supprimer anciennes cases
        calendarDays.innerHTML = "";

        // D√©but du mois
        const firstDay = new Date(year, month, 1).getDay();
        const daysInMonth = new Date(year, month + 1, 0).getDate();

        // D√©calage pour Lundi = 1
        const startIndex = firstDay === 0 ? 6 : firstDay - 1;

        // Cases vides
        for (let i = 0; i < startIndex; i++) {
          calendarDays.innerHTML += `<div></div>`;
        }

        // Jours du mois
        for (let i = 1; i <= daysInMonth; i++) {
          // V√©rifie si ce jour a un event
          const hasEvent = events.some(
            (ev) => ev.day === i && ev.month === month + 1 && ev.year === year
          );

          const isToday =
            i === new Date().getDate() &&
            month === new Date().getMonth() &&
            year === new Date().getFullYear();

          calendarDays.innerHTML += `
        <div class="h-14 flex items-center justify-center relative">

        <span class="
            ${
              isToday
                ? "w-10 h-10 border-2 border-byzantium rounded-full flex items-center justify-center"
                : ""
            }
        ">
            ${i}
        </span>

        ${
          hasEvent
            ? `
            <span class="absolute left-1/2 -bottom-1 transform -translate-x-1/2
            w-2 h-2 bg-byzantium rounded-full"></span>
        `
            : ""
        }
    </div>
    `;
        }
      }

      document.getElementById("prevMonth").onclick = () => {
        date.setMonth(date.getMonth() - 1);
        generateCalendar();
      };

      document.getElementById("nextMonth").onclick = () => {
        date.setMonth(date.getMonth() + 1);
        generateCalendar();
      };

      generateCalendar();
    </script>
  </body>
</html>
